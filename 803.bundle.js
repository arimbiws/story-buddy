/*! For license information please see 803.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[]).push([[729,803],{334(t,n,e){var r=e(424);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function c(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,f=Object.create(c.prototype);return a(f,"_invoke",function(e,r,o){var i,a,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(n,e){return i=n,a=0,c=t,p.n=e,u}};function d(e,r){for(a=e,c=r,n=0;!l&&s&&!o&&n<f.length;n++){var o,i=f[n],d=p.p,y=i[2];e>3?(o=y===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=e<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=e<3||i[0]>r||r>y)&&(i[4]=e,i[5]=r,p.n=y,a=0))}if(o||e>1)return u;throw l=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,y),a=f,c=y;(n=a<2?t:c)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(s=2,i){if(a||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,a<2&&(a=0)}else 1===a&&(n=i.return)&&n.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==u)break}catch(n){i=t,a=1,c=n}finally{s=1}}return{value:n,done:l}}}(e,o,i),!0),f}var u={};function s(){}function f(){}function l(){}n=Object.getPrototypeOf;var p=[][r]?n(n([][r]())):(a(n={},r,function(){return this}),n),d=l.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,a(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return f.prototype=l,a(d,"constructor",l),a(l,"constructor",f),f.displayName="GeneratorFunction",a(l,o,"GeneratorFunction"),a(d),a(d,o,"Generator"),a(d,r,function(){return this}),a(d,"toString",function(){return"[object Generator]"}),(i=function(){return{w:c,m:y}})()}function a(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,n,e,r){function i(n,e){a(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},a(t,n,e,r)}function c(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function u(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){c(i,r,o,a,u,"next",t)}function u(t){c(i,r,o,a,u,"throw",t)}a(void 0)})}}function s(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function f(t){var n=function(t){if("object"!=o(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=o(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(n)?n:n+""}function l(t){var n="function"==typeof Map?new Map:void 0;return l=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(n){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return function(t,n,e){if(p())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,n);var o=new(t.bind.apply(t,r));return e&&d(o,e.prototype),o}(t,arguments,y(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),d(e,t)},l(t)}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(p=function(){return!!t})()}function d(t,n){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},d(t,n)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var v=function(t){function n(){return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),function(t,n,e){return n=y(n),function(t,n){if(n&&("object"==o(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(n,e||[],y(t).constructor):n.apply(t,e))}(this,n,arguments)}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&d(t,n)}(n,t),e=n,a=[{key:"story",set:function(t){this._story=t,this.render()}},{key:"render",value:(c=u(i().m(function t(){var n,e,o;return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r.A.getFavorite(this._story.id);case 1:n=t.v,e=n?"fa-solid":"fa-regular",o=n?"red":"gray",this.innerHTML='\n      <div class="story-card">\n        <img src="'.concat(this._story.photoUrl,'" alt="').concat(this._story.name,'" class="story-image"  loading="lazy"/>\n        <div class="story-content">\n          <h3 class="story-title">').concat(this._story.name,'</h3>\n          <p class="story-description">').concat(this._story.description,'</p>\n\n          <div class="card-actions" style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">\n            <button class="btn-favorite" aria-label="Simpan ke favorit" style="background:none; border:none; cursor:pointer; font-size: 1.5rem; color: ').concat(o,';">\n              <i class="').concat(e,' fa-heart"></i>\n            </button>\n\n            <button class="btn-detail">Detail</button>\n          </div>\n        </div>\n      </div>\n    '),this._addDetailListener(),this._addFavoriteListener();case 2:return t.a(2)}},t,this)})),function(){return c.apply(this,arguments)})},{key:"_addDetailListener",value:function(){var t=this;this.querySelector(".btn-detail").addEventListener("click",function(){t._story.lat&&t._story.lon&&window.focusStoryOnMap&&window.focusStoryOnMap(t._story.lat,t._story.lon,t._story.name),Swal.fire({title:t._story.name,html:'\n          <img src="'.concat(t._story.photoUrl,'" alt="picture uploaded by ').concat(t._story.name,'" style="width:100%;border-radius:8px;margin-bottom:10px;">\n          <p>\n            <strong>Deskripsi:</strong>\n            <br>\n            ').concat(t._story.description,"\n          </p>\n          <br />\n          ").concat(t._story.lat&&t._story.lon?"\n          <p>\n            <strong>Lokasi:</strong> <br />\n            (".concat(t._story.lat,", ").concat(t._story.lon,")\n          </p>"):"","\n        "),confirmButtonText:"Tutup",width:"500px"})})}},{key:"_addFavoriteListener",value:function(){var t=this,n=this.querySelector(".btn-favorite"),e=n.querySelector("i");n.addEventListener("click",function(){var o=u(i().m(function o(a){return i().w(function(o){for(;;)switch(o.n){case 0:return a.stopPropagation(),o.n=1,r.A.getFavorite(t._story.id);case 1:if(!o.v){o.n=3;break}return o.n=2,r.A.deleteFavorite(t._story.id);case 2:e.classList.remove("fa-solid"),e.classList.add("fa-regular"),n.style.color="gray",Swal.fire({toast:!0,position:"top-end",customClass:{popup:"custom-toast"},icon:"info",title:"Dihapus dari favorit",showConfirmButton:!1,timer:1500}),o.n=5;break;case 3:return o.n=4,r.A.putFavorite(t._story);case 4:e.classList.remove("fa-regular"),e.classList.add("fa-solid"),n.style.color="red",Swal.fire({toast:!0,position:"top-end",customClass:{popup:"custom-toast"},icon:"success",title:"Disimpan ke favorit",showConfirmButton:!1,timer:1500});case 5:"/favorites"===window.location.hash&&window.dispatchEvent(new Event("hashchange"));case 6:return o.a(2)}},o)}));return function(t){return o.apply(this,arguments)}}())}}],a&&s(e.prototype,a),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,a,c}(l(HTMLElement));customElements.define("story-card",v)},613(t,n,e){e.d(n,{A:()=>d});var r=e(778),o=e(424);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var a=r&&r.prototype instanceof s?r:s,f=Object.create(a.prototype);return c(f,"_invoke",function(e,r,o){var i,a,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(n,e){return i=n,a=0,c=t,p.n=e,u}};function d(e,r){for(a=e,c=r,n=0;!l&&s&&!o&&n<f.length;n++){var o,i=f[n],d=p.p,y=i[2];e>3?(o=y===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=e<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=e<3||i[0]>r||r>y)&&(i[4]=e,i[5]=r,p.n=y,a=0))}if(o||e>1)return u;throw l=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,y),a=f,c=y;(n=a<2?t:c)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(s=2,i){if(a||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,a<2&&(a=0)}else 1===a&&(n=i.return)&&n.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==u)break}catch(n){i=t,a=1,c=n}finally{s=1}}return{value:n,done:l}}}(e,o,i),!0),f}var u={};function s(){}function f(){}function l(){}n=Object.getPrototypeOf;var p=[][r]?n(n([][r]())):(c(n={},r,function(){return this}),n),d=l.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,c(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return f.prototype=l,c(d,"constructor",l),c(l,"constructor",f),f.displayName="GeneratorFunction",c(l,o,"GeneratorFunction"),c(d),c(d,o,"Generator"),c(d,r,function(){return this}),c(d,"toString",function(){return"[object Generator]"}),(a=function(){return{w:i,m:y}})()}function c(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}c=function(t,n,e,r){function i(n,e){c(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},c(t,n,e,r)}function u(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function s(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){u(i,r,o,a,c,"next",t)}function c(t){u(i,r,o,a,c,"throw",t)}a(void 0)})}}function f(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function l(t){var n=function(t){if("object"!=i(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=i(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(n)?n:n+""}var p=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)},n=[{key:"getAllStories",value:(i=s(a().m(function t(){var n,e,i;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n=localStorage.getItem("token")){t.n=1;break}throw new Error("Token tidak ditemukan. Harap login kembali.");case 1:return t.p=1,t.n=2,(0,r.wF)(n);case 2:return e=t.v,t.n=3,o.A.putStories(e);case 3:return t.a(2,e);case 4:return t.p=4,t.v,console.warn("Offline Mode: Mengambil data dari IndexedDB"),t.n=5,o.A.getAllStories();case 5:if(!((i=t.v).length>0)){t.n=6;break}return t.a(2,i);case 6:throw new Error("Gagal mengambil data offline dan cache kosong.");case 7:return t.a(2)}},t,null,[[1,4]])})),function(){return i.apply(this,arguments)})},{key:"createStory",value:(e=s(a().m(function t(n){var e,i,c,u,s,f;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e=localStorage.getItem("token")){t.n=1;break}throw new Error("Token tidak ditemukan. Harap login kembali.");case 1:return i=n.description||n.desc||"",t.p=2,t.n=3,(0,r.LD)({description:i,photo:n.photo,lat:n.lat,lon:n.lon,token:e});case 3:return t.a(2,t.v);case 4:if(t.p=4,s=t.v,navigator.onLine){t.n=10;break}if(t.p=5,c=null,u=null,!n.photo){t.n=7;break}return u=n.photo.type||"image/jpeg",t.n=6,new Promise(function(t,e){var r=new FileReader;r.onload=function(){var n=r.result.split(",")[1];t(n)},r.onerror=e,r.readAsDataURL(n.photo)});case 6:c=t.v;case 7:return t.n=8,o.A.saveToQueue({description:i,lat:n.lat,lon:n.lon,photoBase64:c,photoType:u,timestamp:Date.now()});case 8:return t.a(2,{offline:!0,message:"Disimpan di antrian offline"});case 9:throw t.p=9,f=t.v,console.error("Gagal menyimpan ke antrian offline:",f),f;case 10:throw s;case 11:return t.a(2)}},t,null,[[5,9],[2,4]])})),function(t){return e.apply(this,arguments)})}],n&&f(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,i}();const d=p},729(t,n,e){e.r(n),e.d(n,{default:()=>u});var r=e(255);function o(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",a=e.toStringTag||"@@toStringTag";function c(e,r,o,a){var c=r&&r.prototype instanceof s?r:s,f=Object.create(c.prototype);return i(f,"_invoke",function(e,r,o){var i,a,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(n,e){return i=n,a=0,c=t,p.n=e,u}};function d(e,r){for(a=e,c=r,n=0;!l&&s&&!o&&n<f.length;n++){var o,i=f[n],d=p.p,y=i[2];e>3?(o=y===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=e<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=e<3||i[0]>r||r>y)&&(i[4]=e,i[5]=r,p.n=y,a=0))}if(o||e>1)return u;throw l=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,y),a=f,c=y;(n=a<2?t:c)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(s=2,i){if(a||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,a<2&&(a=0)}else 1===a&&(n=i.return)&&n.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==u)break}catch(n){i=t,a=1,c=n}finally{s=1}}return{value:n,done:l}}}(e,o,a),!0),f}var u={};function s(){}function f(){}function l(){}n=Object.getPrototypeOf;var p=[][r]?n(n([][r]())):(i(n={},r,function(){return this}),n),d=l.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,i(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return f.prototype=l,i(d,"constructor",l),i(l,"constructor",f),f.displayName="GeneratorFunction",i(l,a,"GeneratorFunction"),i(d),i(d,a,"Generator"),i(d,r,function(){return this}),i(d,"toString",function(){return"[object Generator]"}),(o=function(){return{w:c,m:y}})()}function i(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}i=function(t,n,e,r){function a(n,e){i(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(a("next",0),a("throw",1),a("return",2))},i(t,n,e,r)}function a(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function c(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function c(t){a(i,r,o,c,u,"next",t)}function u(t){a(i,r,o,c,u,"throw",t)}c(void 0)})}}const u={requestPermission:function(){return c(o().m(function t(){var n;return o().w(function(t){for(;;)switch(t.n){case 0:if("Notification"in window){t.n=1;break}return console.log("Browser tidak mendukung notifikasi."),t.a(2,!1);case 1:return t.n=2,Notification.requestPermission();case 2:return n=t.v,t.a(2,"granted"===n)}},t)}))()},checkSubscriptionStatus:function(){return c(o().m(function t(){var n,e;return o().w(function(t){for(;;)switch(t.n){case 0:if("serviceWorker"in navigator){t.n=1;break}return t.a(2,!1);case 1:return t.n=2,navigator.serviceWorker.ready;case 2:return n=t.v,t.n=3,n.pushManager.getSubscription();case 3:return e=t.v,t.a(2,!!e)}},t)}))()},subscribePush:function(){var t=this;return c(o().m(function n(){var e,i,a,c;return o().w(function(n){for(;;)switch(n.n){case 0:if("serviceWorker"in navigator){n.n=1;break}return n.a(2);case 1:return n.n=2,navigator.serviceWorker.ready;case 2:return e=n.v,n.n=3,e.pushManager.getSubscription();case 3:if(i=n.v){n.n=5;break}return a={userVisibleOnly:!0,applicationServerKey:function(t){for(var n=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),e=window.atob(n),r=new Uint8Array(e.length),o=0;o<e.length;++o)r[o]=e.charCodeAt(o);return r}(r.$.PUSH_MSG_VAPID_PUBLIC_KEY)},n.n=4,e.pushManager.subscribe(a);case 4:i=n.v;case 5:if(!(c=localStorage.getItem("token"))){n.n=6;break}return n.n=6,t._sendSubscriptionToAPI(i,c);case 6:return console.log("Berhasil Subscribe:",JSON.stringify(i)),n.a(2,i)}},n)}))()},unsubscribePush:function(){return c(o().m(function t(){var n,e;return o().w(function(t){for(;;)switch(t.n){case 0:if("serviceWorker"in navigator){t.n=1;break}return t.a(2);case 1:return t.n=2,navigator.serviceWorker.ready;case 2:return n=t.v,t.n=3,n.pushManager.getSubscription();case 3:if(!(e=t.v)){t.n=5;break}return t.n=4,e.unsubscribe();case 4:return console.log("Berhasil Unsubscribe"),t.a(2,!0);case 5:return t.a(2)}},t)}))()},_sendSubscriptionToAPI:function(t,n){return c(o().m(function e(){var i,a,c,u,s;return o().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,i=t.toJSON(),a={endpoint:i.endpoint,keys:i.keys},e.n=1,fetch(r.$.PUSH_MSG_SUBSCRIBE_URL,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify(a)});case 1:return c=e.v,e.n=2,c.json();case 2:if(u=e.v,console.log("Respon Server Notifikasi:",u),c.ok){e.n=3;break}throw new Error(u.message||"Gagal mengirim subscription ke server");case 3:e.n=5;break;case 4:e.p=4,s=e.v,console.error("Gagal mengirim subscription ke server:",s);case 5:return e.a(2)}},e,null,[[0,4]])}))()}}},803(t,n,e){e.d(n,{default:()=>O});var r=e(958);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function c(e,r,o,i){var c=r&&r.prototype instanceof s?r:s,f=Object.create(c.prototype);return a(f,"_invoke",function(e,r,o){var i,a,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(n,e){return i=n,a=0,c=t,p.n=e,u}};function d(e,r){for(a=e,c=r,n=0;!l&&s&&!o&&n<f.length;n++){var o,i=f[n],d=p.p,y=i[2];e>3?(o=y===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=e<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=e<3||i[0]>r||r>y)&&(i[4]=e,i[5]=r,p.n=y,a=0))}if(o||e>1)return u;throw l=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,y),a=f,c=y;(n=a<2?t:c)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(s=2,i){if(a||(o="next"),n=i[o]){if(!(n=n.call(i,c)))throw TypeError("iterator result is not an object");if(!n.done)return n;c=n.value,a<2&&(a=0)}else 1===a&&(n=i.return)&&n.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((n=(l=p.n<0)?c:e.call(r,p))!==u)break}catch(n){i=t,a=1,c=n}finally{s=1}}return{value:n,done:l}}}(e,o,i),!0),f}var u={};function s(){}function f(){}function l(){}n=Object.getPrototypeOf;var p=[][r]?n(n([][r]())):(a(n={},r,function(){return this}),n),d=l.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,a(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return f.prototype=l,a(d,"constructor",l),a(l,"constructor",f),f.displayName="GeneratorFunction",a(l,o,"GeneratorFunction"),a(d),a(d,o,"Generator"),a(d,r,function(){return this}),a(d,"toString",function(){return"[object Generator]"}),(i=function(){return{w:c,m:y}})()}function a(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,n,e,r){function i(n,e){a(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},a(t,n,e,r)}function c(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function u(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s(r.key),r)}}function s(t){var n=function(t){if("object"!=o(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=o(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(n)?n:n+""}var f=function(){return t=function t(n){var e=n.view,r=n.model;!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e,this.model=r,this._stories=[]},n=[{key:"showStories",value:(e=i().m(function t(){var n;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,localStorage.getItem("token")){t.n=1;break}return(0,r.V)("/login"),t.a(2);case 1:return this.view.showLoading(),t.n=2,this.model.getAllStories();case 2:this._stories=t.v,this.view.showStoriesList(this._stories),this.view.initMap(this._stories),t.n=4;break;case 3:t.p=3,n=t.v,console.error(n);case 4:return t.p=4,this.view.hideLoading(),t.f(4);case 5:return t.a(2)}},t,this,[[0,3,4,5]])}),o=function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(t){c(i,r,o,a,u,"next",t)}function u(t){c(i,r,o,a,u,"throw",t)}a(void 0)})},function(){return o.apply(this,arguments)})},{key:"searchStories",value:function(t){if(t){var n=t.toLowerCase(),e=this._stories.filter(function(t){var e=t.name.toLowerCase().includes(n),r=t.description.toLowerCase().includes(n);return e||r});this.view.showStoriesList(e)}else this.view.showStoriesList(this._stories)}}],n&&u(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,o}();const l=f;var p=e(613),d=e(481),y=e.n(d),v=e(927),b=e(980),h=y().icon({iconUrl:v,shadowUrl:b});y().Marker.prototype.options.icon=h;e(334);var m=e(880),g=e(729);function w(){var t,n,e="function"==typeof Symbol?Symbol:{},r=e.iterator||"@@iterator",o=e.toStringTag||"@@toStringTag";function i(e,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return k(s,"_invoke",function(e,r,o){var i,c,u,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(n,e){return i=n,c=0,u=t,p.n=e,a}};function d(e,r){for(c=e,u=r,n=0;!l&&s&&!o&&n<f.length;n++){var o,i=f[n],d=p.p,y=i[2];e>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=e<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=e<3||i[0]>r||r>y)&&(i[4]=e,i[5]=r,p.n=y,c=0))}if(o||e>1)return a;throw l=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,y),c=f,u=y;(n=c<2?t:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),n=i[o]){if(!(n=n.call(i,u)))throw TypeError("iterator result is not an object");if(!n.done)return n;u=n.value,c<2&&(c=0)}else 1===c&&(n=i.return)&&n.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((n=(l=p.n<0)?u:e.call(r,p))!==a)break}catch(n){i=t,c=1,u=n}finally{s=1}}return{value:n,done:l}}}(e,o,i),!0),s}var a={};function c(){}function u(){}function s(){}n=Object.getPrototypeOf;var f=[][r]?n(n([][r]())):(k(n={},r,function(){return this}),n),l=s.prototype=c.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,k(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return u.prototype=s,k(l,"constructor",s),k(s,"constructor",u),u.displayName="GeneratorFunction",k(s,o,"GeneratorFunction"),k(l),k(l,o,"Generator"),k(l,r,function(){return this}),k(l,"toString",function(){return"[object Generator]"}),(w=function(){return{w:i,m:p}})()}function k(t,n,e,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}k=function(t,n,e,r){function i(n,e){k(t,n,function(t){return this._invoke(n,e,t)})}n?o?o(t,n,{value:e,enumerable:!r,configurable:!r,writable:!r}):t[n]=e:(i("next",0),i("throw",1),i("return",2))},k(t,n,e,r)}function S(t,n,e,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void e(t)}c.done?n(u):Promise.resolve(u).then(r,o)}function _(t){return function(){var n=this,e=arguments;return new Promise(function(r,o){var i=t.apply(n,e);function a(t){S(i,r,o,a,c,"next",t)}function c(t){S(i,r,o,a,c,"throw",t)}a(void 0)})}}const O={render:function(){return _(w().m(function t(){return w().w(function(t){for(;;)if(0===t.n)return t.a(2,'\n      <section class="container home-page">\n        <header class="page-header">\n          <h2 class="page-title">Beranda Cerita</h2>\n          <p class="page-subtitle">Lihat kisah dan lokasi para pengguna di seluruh Indonesia</p>\n        </header>\n\n        <div id="loading-container"></div>\n        <div id="offline-banner" style="display:none; background: #ffeba7; padding: 10px; text-align: center; border-radius: 8px; margin-bottom: 10px;">\n           Anda sedang offline. Data yang ditampilkan mungkin tidak terbaru.\n        </div>\n\n        <section id="map-section" aria-label="Peta Lokasi Cerita">\n          <div id="map"></div>\n        </section>\n\n        <section id="stories-section" aria-label="Daftar Cerita">\n          <h3 class="section-title">Daftar Cerita</h3>\n          <div class="search-wrapper">\n            <input \n              type="text" \n              id="searchStories" \n              placeholder="Cari cerita berdasarkan nama atau deskripsi..." \n              class="form-control"\n              style="padding: 12px; border-radius: 8px; border: 1px solid #d8d8d8ff;"\n            />\n          </div>\n          <div id="stories" class="story-list"></div>\n        </section>\n      </section>\n    ')},t)}))()},afterRender:function(){var t=this;return _(w().m(function n(){var e,r;return w().w(function(n){for(;;)switch(n.n){case 0:return e=new p.A,r=new l({view:t,model:e}),window.addEventListener("online",function(){return t._updateOnlineStatus()}),window.addEventListener("offline",function(){return t._updateOnlineStatus()}),t._updateOnlineStatus(),document.getElementById("searchStories").addEventListener("input",function(t){r.searchStories(t.target.value)}),n.n=1,r.showStories();case 1:t._animateElements();case 2:return n.a(2)}},n)}))()},_updateOnlineStatus:function(){var t=document.getElementById("offline-banner");navigator.onLine?t.style.display="none":t.style.display="block"},_initNotificationButton:function(){var t=document.getElementById("notifToggle");"Notification"in window?t.addEventListener("click",_(w().m(function n(){return w().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,g.default.requestPermission();case 1:if(!n.v){n.n=3;break}return n.n=2,g.default.subscribePush();case 2:t.innerText="Notifikasi Aktif",t.classList.remove("btn-secondary"),t.classList.add("btn-primary"),Swal.fire("Berhasil","Anda akan menerima notifikasi cerita baru.","success"),n.n=4;break;case 3:Swal.fire("Gagal","Izin notifikasi ditolak.","error");case 4:return n.a(2)}},n)}))):t.style.display="none"},showLoading:function(){document.getElementById("loading-container").innerHTML='<div class="loader" style="text-align:center; padding:2rem;">Memuat data...</div>'},hideLoading:function(){document.getElementById("loading-container").innerHTML=""},showStoriesList:function(t){var n=document.getElementById("stories");n.innerHTML="",0!==t.length?t.forEach(function(t){var e=document.createElement("story-card");e.story=t,n.appendChild(e)}):n.innerHTML="<p style='text-align:center; col-span: 3;'>Tidak ada cerita ditemukan.</p>"},initMap:function(t){!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=document.getElementById("map");if(n){n._leaflet_id&&(n._leaflet_id=null);var e=y().map("map").setView([-2.5489,118.0149],5),r=y().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),o=y().tileLayer("https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png");r.addTo(e);var i=[],a=y().layerGroup();t.forEach(function(t){if(t.lat&&t.lon){var n=y().marker([t.lat,t.lon]);n.bindPopup("<b>".concat(t.name,"</b><br>").concat(t.description)),a.addLayer(n),i.push([t.lat,t.lon])}}),a.addTo(e),y().control.layers({Default:r,Satellite:o},{"Lokasi Cerita":a}).addTo(e),i.length>0&&e.fitBounds(i),window.focusStoryOnMap=function(t,n,r){e.setView([t,n],10,{animate:!0}),y().popup().setLatLng([t,n]).setContent("<b>".concat(r,"</b>")).openOn(e)}}}(t)},_animateElements:function(){m.os.from("#map-section",{opacity:0,y:30,duration:.8,ease:"power2.out"}),m.os.from("#stories-section",{opacity:0,y:50,duration:.8,delay:.3,ease:"power2.out"})}}}}]);