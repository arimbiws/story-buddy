/*! For license information please see 803.bundle.js.LICENSE.txt */
"use strict";(self.webpackChunkapp_starter_project_with_webpack=self.webpackChunkapp_starter_project_with_webpack||[]).push([[729,803],{334(t,e,n){var r=n(424);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function c(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,f=Object.create(c.prototype);return a(f,"_invoke",function(n,r,o){var i,a,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,c=t,p.n=n,u}};function d(n,r){for(a=n,c=r,e=0;!l&&s&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,y=i[2];n>3?(o=y===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw l=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,y),a=f,c=y;(e=a<2?t:c)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(s=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==u)break}catch(e){i=t,a=1,c=e}finally{s=1}}return{value:e,done:l}}}(n,o,i),!0),f}var u={};function s(){}function f(){}function l(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(a(e={},r,function(){return this}),e),d=l.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,a(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return f.prototype=l,a(d,"constructor",l),a(l,"constructor",f),f.displayName="GeneratorFunction",a(l,o,"GeneratorFunction"),a(d),a(d,o,"Generator"),a(d,r,function(){return this}),a(d,"toString",function(){return"[object Generator]"}),(i=function(){return{w:c,m:y}})()}function a(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,e,n,r){function i(e,n){a(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},a(t,e,n,r)}function c(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function u(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){c(i,r,o,a,u,"next",t)}function u(t){c(i,r,o,a,u,"throw",t)}a(void 0)})}}function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,f(r.key),r)}}function f(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}function l(t){var e="function"==typeof Map?new Map:void 0;return l=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(e){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return function(t,e,n){if(p())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,e);var o=new(t.bind.apply(t,r));return n&&d(o,n.prototype),o}(t,arguments,y(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),d(n,t)},l(t)}function p(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(p=function(){return!!t})()}function d(t,e){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},d(t,e)}function y(t){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},y(t)}var v=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e,n){return e=y(e),function(t,e){if(e&&("object"==o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,p()?Reflect.construct(e,n||[],y(t).constructor):e.apply(t,n))}(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e)}(e,t),n=e,a=[{key:"story",set:function(t){this._story=t,this.render()}},{key:"render",value:(c=u(i().m(function t(){var e,n,o,a;return i().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,r.A.getFavorite(this._story.id);case 1:e=t.v,n=e?"fa-solid":"fa-regular",o=e?"red":"gray",a=this._story.createdAt?new Date(this._story.createdAt).toLocaleDateString("id-ID",{year:"numeric",month:"long",day:"numeric"}):"-",this.innerHTML='\n      <div class="story-card">\n        <img src="'.concat(this._story.photoUrl,'" alt="').concat(this._story.name,'" class="story-image"  loading="lazy" onerror="this.src=\'/images/placeholder.png\'"/>\n        <div class="story-content">\n          <small class="story-date">').concat(a,'</small>\n          <h3 class="story-title">').concat(this._story.name,'</h3>\n          <p class="story-description">').concat(this._story.description,'</p>\n\n          <div class="card-actions" style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">\n            <button class="btn-favorite" aria-label="Simpan ke favorit" style="background:none; border:none; cursor:pointer; font-size: 1.5rem; color: ').concat(o,';">\n              <i class="').concat(n,' fa-heart"></i>\n            </button>\n\n            <button class="btn-detail">Detail</button>\n          </div>\n        </div>\n      </div>\n    '),this._addDetailListener(),this._addFavoriteListener();case 2:return t.a(2)}},t,this)})),function(){return c.apply(this,arguments)})},{key:"_addDetailListener",value:function(){var t=this;this.querySelector(".btn-detail").addEventListener("click",function(){t._story.lat&&t._story.lon&&window.focusStoryOnMap&&window.focusStoryOnMap(t._story.lat,t._story.lon,t._story.name),Swal.fire({title:t._story.name,html:'\n          <img src="'.concat(t._story.photoUrl,'" alt="picture uploaded by ').concat(t._story.name,'" style="width:100%;border-radius:8px;margin-bottom:10px;">\n          <p>\n            <strong>Deskripsi:</strong>\n            <br>\n            ').concat(t._story.description,"\n          </p>\n          <br />\n          ").concat(t._story.lat&&t._story.lon?"\n          <p>\n            <strong>Lokasi:</strong> <br />\n            (".concat(t._story.lat,", ").concat(t._story.lon,")\n          </p>"):"","\n        "),confirmButtonText:"Tutup",width:"500px"})})}},{key:"_addFavoriteListener",value:function(){var t=this,e=this.querySelector(".btn-favorite"),n=e.querySelector("i");e.addEventListener("click",function(){var o=u(i().m(function o(a){return i().w(function(o){for(;;)switch(o.n){case 0:return a.stopPropagation(),o.n=1,r.A.getFavorite(t._story.id);case 1:if(!o.v){o.n=3;break}return o.n=2,r.A.deleteFavorite(t._story.id);case 2:n.classList.remove("fa-solid"),n.classList.add("fa-regular"),e.style.color="gray",Swal.fire({toast:!0,position:"top-end",customClass:{popup:"custom-toast"},icon:"info",title:"Dihapus dari favorit",showConfirmButton:!1,timer:1500}),o.n=5;break;case 3:return o.n=4,r.A.putFavorite(t._story);case 4:n.classList.remove("fa-regular"),n.classList.add("fa-solid"),e.style.color="red",Swal.fire({toast:!0,position:"top-end",customClass:{popup:"custom-toast"},icon:"success",title:"Disimpan ke favorit",showConfirmButton:!1,timer:1500});case 5:"/favorites"===window.location.hash&&window.dispatchEvent(new Event("hashchange"));case 6:return o.a(2)}},o)}));return function(t){return o.apply(this,arguments)}}())}}],a&&s(n.prototype,a),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,a,c}(l(HTMLElement));customElements.define("story-card",v)},613(t,e,n){n.d(e,{A:()=>d});var r=n(778),o=n(424);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var a=r&&r.prototype instanceof s?r:s,f=Object.create(a.prototype);return c(f,"_invoke",function(n,r,o){var i,a,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,c=t,p.n=n,u}};function d(n,r){for(a=n,c=r,e=0;!l&&s&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,y=i[2];n>3?(o=y===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw l=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,y),a=f,c=y;(e=a<2?t:c)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(s=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==u)break}catch(e){i=t,a=1,c=e}finally{s=1}}return{value:e,done:l}}}(n,o,i),!0),f}var u={};function s(){}function f(){}function l(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(c(e={},r,function(){return this}),e),d=l.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,c(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return f.prototype=l,c(d,"constructor",l),c(l,"constructor",f),f.displayName="GeneratorFunction",c(l,o,"GeneratorFunction"),c(d),c(d,o,"Generator"),c(d,r,function(){return this}),c(d,"toString",function(){return"[object Generator]"}),(a=function(){return{w:i,m:y}})()}function c(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}c=function(t,e,n,r){function i(e,n){c(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},c(t,e,n,r)}function u(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function s(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){u(i,r,o,a,c,"next",t)}function c(t){u(i,r,o,a,c,"throw",t)}a(void 0)})}}function f(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,l(r.key),r)}}function l(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}var p=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"getAllStories",value:(i=s(a().m(function t(){var e,n,i;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:if(e=localStorage.getItem("token")){t.n=1;break}throw new Error("Token tidak ditemukan. Harap login kembali.");case 1:return t.p=1,t.n=2,(0,r.wF)(e);case 2:return n=t.v,t.n=3,o.A.putStories(n);case 3:return t.a(2,n);case 4:return t.p=4,t.v,console.warn("Offline Mode: Mengambil data dari IndexedDB"),t.n=5,o.A.getAllStories();case 5:if(!((i=t.v).length>0)){t.n=6;break}return t.a(2,i);case 6:throw new Error("Gagal mengambil data offline dan cache kosong.");case 7:return t.a(2)}},t,null,[[1,4]])})),function(){return i.apply(this,arguments)})},{key:"createStory",value:(n=s(a().m(function t(e){var n,i,c,u,s,f;return a().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n=localStorage.getItem("token")){t.n=1;break}throw new Error("Token tidak ditemukan. Harap login kembali.");case 1:return i=e.description||e.desc||"",t.p=2,t.n=3,(0,r.LD)({description:i,photo:e.photo,lat:e.lat,lon:e.lon,token:n});case 3:return t.a(2,t.v);case 4:if(t.p=4,s=t.v,navigator.onLine){t.n=10;break}if(t.p=5,c=null,u=null,!e.photo){t.n=7;break}return u=e.photo.type||"image/jpeg",t.n=6,new Promise(function(t,n){var r=new FileReader;r.onload=function(){var e=r.result.split(",")[1];t(e)},r.onerror=n,r.readAsDataURL(e.photo)});case 6:c=t.v;case 7:return t.n=8,o.A.saveToQueue({description:i,lat:e.lat,lon:e.lon,photoBase64:c,photoType:u,timestamp:Date.now()});case 8:return t.a(2,{offline:!0,message:"Disimpan di antrian offline"});case 9:throw t.p=9,f=t.v,console.error("Gagal menyimpan ke antrian offline:",f),f;case 10:throw s;case 11:return t.a(2)}},t,null,[[5,9],[2,4]])})),function(t){return n.apply(this,arguments)})}],e&&f(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,i}();const d=p},729(t,e,n){n.r(e),n.d(e,{default:()=>u});var r=n(255);function o(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",a=n.toStringTag||"@@toStringTag";function c(n,r,o,a){var c=r&&r.prototype instanceof s?r:s,f=Object.create(c.prototype);return i(f,"_invoke",function(n,r,o){var i,a,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,c=t,p.n=n,u}};function d(n,r){for(a=n,c=r,e=0;!l&&s&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,y=i[2];n>3?(o=y===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw l=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,y),a=f,c=y;(e=a<2?t:c)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(s=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==u)break}catch(e){i=t,a=1,c=e}finally{s=1}}return{value:e,done:l}}}(n,o,a),!0),f}var u={};function s(){}function f(){}function l(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(i(e={},r,function(){return this}),e),d=l.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,i(t,a,"GeneratorFunction")),t.prototype=Object.create(d),t}return f.prototype=l,i(d,"constructor",l),i(l,"constructor",f),f.displayName="GeneratorFunction",i(l,a,"GeneratorFunction"),i(d),i(d,a,"Generator"),i(d,r,function(){return this}),i(d,"toString",function(){return"[object Generator]"}),(o=function(){return{w:c,m:y}})()}function i(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}i=function(t,e,n,r){function a(e,n){i(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(a("next",0),a("throw",1),a("return",2))},i(t,e,n,r)}function a(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function c(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function c(t){a(i,r,o,c,u,"next",t)}function u(t){a(i,r,o,c,u,"throw",t)}c(void 0)})}}const u={requestPermission:function(){return c(o().m(function t(){var e;return o().w(function(t){for(;;)switch(t.n){case 0:if("Notification"in window){t.n=1;break}return console.log("Browser tidak mendukung notifikasi."),t.a(2,!1);case 1:return t.n=2,Notification.requestPermission();case 2:return e=t.v,t.a(2,"granted"===e)}},t)}))()},checkSubscriptionStatus:function(){return c(o().m(function t(){var e,n;return o().w(function(t){for(;;)switch(t.n){case 0:if("serviceWorker"in navigator){t.n=1;break}return t.a(2,!1);case 1:return t.n=2,navigator.serviceWorker.ready;case 2:return e=t.v,t.n=3,e.pushManager.getSubscription();case 3:return n=t.v,t.a(2,!!n)}},t)}))()},subscribePush:function(){var t=this;return c(o().m(function e(){var n,i,a,c;return o().w(function(e){for(;;)switch(e.n){case 0:if("serviceWorker"in navigator){e.n=1;break}return e.a(2);case 1:return e.n=2,navigator.serviceWorker.ready;case 2:return n=e.v,e.n=3,n.pushManager.getSubscription();case 3:if(i=e.v){e.n=5;break}return a={userVisibleOnly:!0,applicationServerKey:function(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(e),r=new Uint8Array(n.length),o=0;o<n.length;++o)r[o]=n.charCodeAt(o);return r}(r.$.PUSH_MSG_VAPID_PUBLIC_KEY)},e.n=4,n.pushManager.subscribe(a);case 4:i=e.v;case 5:if(!(c=localStorage.getItem("token"))){e.n=6;break}return e.n=6,t._sendSubscriptionToAPI(i,c);case 6:return console.log("Berhasil Subscribe:",JSON.stringify(i)),e.a(2,i)}},e)}))()},unsubscribePush:function(){return c(o().m(function t(){var e,n,i,a;return o().w(function(t){for(;;)switch(t.n){case 0:if("serviceWorker"in navigator){t.n=1;break}return t.a(2);case 1:return t.n=2,navigator.serviceWorker.ready;case 2:return e=t.v,t.n=3,e.pushManager.getSubscription();case 3:if(n=t.v){t.n=4;break}return t.a(2);case 4:if(i=localStorage.getItem("token")){t.n=5;break}return t.a(2);case 5:return a=n.toJSON(),t.n=6,fetch(r.$.PUSH_MSG_UNSUBSCRIBE_URL,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(i)},body:JSON.stringify({endpoint:a.endpoint})});case 6:return t.n=7,n.unsubscribe();case 7:console.log("Unsubscribe berhasil (server + browser)");case 8:return t.a(2)}},t)}))()},_sendSubscriptionToAPI:function(t,e){return c(o().m(function n(){var i,a,c,u,s;return o().w(function(n){for(;;)switch(n.p=n.n){case 0:return n.p=0,i=t.toJSON(),a={endpoint:i.endpoint,keys:i.keys},n.n=1,fetch(r.$.PUSH_MSG_SUBSCRIBE_URL,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(a)});case 1:return c=n.v,n.n=2,c.json();case 2:if(u=n.v,console.log("Respon Server Notifikasi:",u),c.ok){n.n=3;break}throw new Error(u.message||"Gagal mengirim subscription ke server");case 3:n.n=5;break;case 4:n.p=4,s=n.v,console.error("Gagal mengirim subscription ke server:",s);case 5:return n.a(2)}},n,null,[[0,4]])}))()}}},803(t,e,n){n.d(e,{default:()=>O});var r=n(958);function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function i(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function c(n,r,o,i){var c=r&&r.prototype instanceof s?r:s,f=Object.create(c.prototype);return a(f,"_invoke",function(n,r,o){var i,a,c,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,a=0,c=t,p.n=n,u}};function d(n,r){for(a=n,c=r,e=0;!l&&s&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,y=i[2];n>3?(o=y===r)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(a=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,a=0))}if(o||n>1)return u;throw l=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,y),a=f,c=y;(e=a<2?t:c)||!l;){i||(a?a<3?(a>1&&(p.n=-1),d(a,c)):p.n=c:p.v=c);try{if(s=2,i){if(a||(o="next"),e=i[o]){if(!(e=e.call(i,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,a<2&&(a=0)}else 1===a&&(e=i.return)&&e.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((e=(l=p.n<0)?c:n.call(r,p))!==u)break}catch(e){i=t,a=1,c=e}finally{s=1}}return{value:e,done:l}}}(n,o,i),!0),f}var u={};function s(){}function f(){}function l(){}e=Object.getPrototypeOf;var p=[][r]?e(e([][r]())):(a(e={},r,function(){return this}),e),d=l.prototype=s.prototype=Object.create(p);function y(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,a(t,o,"GeneratorFunction")),t.prototype=Object.create(d),t}return f.prototype=l,a(d,"constructor",l),a(l,"constructor",f),f.displayName="GeneratorFunction",a(l,o,"GeneratorFunction"),a(d),a(d,o,"Generator"),a(d,r,function(){return this}),a(d,"toString",function(){return"[object Generator]"}),(i=function(){return{w:c,m:y}})()}function a(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}a=function(t,e,n,r){function i(e,n){a(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},a(t,e,n,r)}function c(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function u(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,s(r.key),r)}}function s(t){var e=function(t){if("object"!=o(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==o(e)?e:e+""}var f=function(){return t=function t(e){var n=e.view,r=e.model;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=n,this.model=r,this._stories=[]},e=[{key:"showStories",value:(n=i().m(function t(){var e;return i().w(function(t){for(;;)switch(t.p=t.n){case 0:if(t.p=0,localStorage.getItem("token")){t.n=1;break}return(0,r.V)("/login"),t.a(2);case 1:return this.view.showLoading(),t.n=2,this.model.getAllStories();case 2:if(this._stories=t.v,0!==this._stories.length){t.n=3;break}return this.view.showOfflineEmptyState(),t.a(2);case 3:this.view.showStoriesList(this._stories),this.view.initMap(this._stories),t.n=5;break;case 4:t.p=4,e=t.v,console.error("Gagal memuat cerita:",e),this.view.showOfflineError();case 5:return t.p=5,this.view.hideLoading(),t.f(5);case 6:return t.a(2)}},t,this,[[0,4,5,6]])}),o=function(){var t=this,e=arguments;return new Promise(function(r,o){var i=n.apply(t,e);function a(t){c(i,r,o,a,u,"next",t)}function u(t){c(i,r,o,a,u,"throw",t)}a(void 0)})},function(){return o.apply(this,arguments)})},{key:"searchStories",value:function(t){if(t){var e=t.toLowerCase(),n=this._stories.filter(function(t){var n=t.name.toLowerCase().includes(e),r=t.description.toLowerCase().includes(e);return n||r});this.view.showStoriesList(n)}else this.view.showStoriesList(this._stories)}}],e&&u(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,o}();const l=f;var p=n(613),d=n(481),y=n.n(d),v=n(927),h=n(980),b=y().icon({iconUrl:v,shadowUrl:h});y().Marker.prototype.options.icon=b;n(334);var m=n(880),g=n(729);function w(){var t,e,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function i(n,r,o,i){var u=r&&r.prototype instanceof c?r:c,s=Object.create(u.prototype);return k(s,"_invoke",function(n,r,o){var i,c,u,s=0,f=o||[],l=!1,p={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,n){return i=e,c=0,u=t,p.n=n,a}};function d(n,r){for(c=n,u=r,e=0;!l&&s&&!o&&e<f.length;e++){var o,i=f[e],d=p.p,y=i[2];n>3?(o=y===r)&&(u=i[(c=i[4])?5:(c=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=n<2&&d<i[1])?(c=0,p.v=r,p.n=i[1]):d<y&&(o=n<3||i[0]>r||r>y)&&(i[4]=n,i[5]=r,p.n=y,c=0))}if(o||n>1)return a;throw l=!0,r}return function(o,f,y){if(s>1)throw TypeError("Generator is already running");for(l&&1===f&&d(f,y),c=f,u=y;(e=c<2?t:u)||!l;){i||(c?c<3?(c>1&&(p.n=-1),d(c,u)):p.n=u:p.v=u);try{if(s=2,i){if(c||(o="next"),e=i[o]){if(!(e=e.call(i,u)))throw TypeError("iterator result is not an object");if(!e.done)return e;u=e.value,c<2&&(c=0)}else 1===c&&(e=i.return)&&e.call(i),c<2&&(u=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=t}else if((e=(l=p.n<0)?u:n.call(r,p))!==a)break}catch(e){i=t,c=1,u=e}finally{s=1}}return{value:e,done:l}}}(n,o,i),!0),s}var a={};function c(){}function u(){}function s(){}e=Object.getPrototypeOf;var f=[][r]?e(e([][r]())):(k(e={},r,function(){return this}),e),l=s.prototype=c.prototype=Object.create(f);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,k(t,o,"GeneratorFunction")),t.prototype=Object.create(l),t}return u.prototype=s,k(l,"constructor",s),k(s,"constructor",u),u.displayName="GeneratorFunction",k(s,o,"GeneratorFunction"),k(l),k(l,o,"Generator"),k(l,r,function(){return this}),k(l,"toString",function(){return"[object Generator]"}),(w=function(){return{w:i,m:p}})()}function k(t,e,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(t){o=0}k=function(t,e,n,r){function i(e,n){k(t,e,function(t){return this._invoke(e,n,t)})}e?o?o(t,e,{value:n,enumerable:!r,configurable:!r,writable:!r}):t[e]=n:(i("next",0),i("throw",1),i("return",2))},k(t,e,n,r)}function S(t,e,n,r,o,i,a){try{var c=t[i](a),u=c.value}catch(t){return void n(t)}c.done?e(u):Promise.resolve(u).then(r,o)}function _(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function a(t){S(i,r,o,a,c,"next",t)}function c(t){S(i,r,o,a,c,"throw",t)}a(void 0)})}}const O={render:function(){return _(w().m(function t(){return w().w(function(t){for(;;)if(0===t.n)return t.a(2,'\n      <section class="container home-page">\n        <header class="page-header">\n          <h1 class="page-title">Beranda Cerita</h1>\n          <p class="page-subtitle">Lihat kisah dan lokasi para pengguna di seluruh Indonesia</p>\n        </header>\n\n        <div id="loading-container"></div>\n        <div id="offline-banner" style="display:none; background: #ffeba7; padding: 10px; text-align: center; border-radius: 8px; margin-bottom: 10px;">\n           Anda sedang offline. Data yang ditampilkan mungkin tidak terbaru.\n        </div>\n\n        <section id="map-section" aria-label="Peta Lokasi Cerita">\n          <div id="map"></div>\n        </section>\n\n        <section id="stories-section" aria-label="Daftar Cerita">\n          <h2 class="section-title">Daftar Cerita</h2>\n          <div class="search-wrapper">\n            <label for="searchStories" class="visually-hidden">\n              Cari cerita\n            </label>\n            <input \n              type="text" \n              id="searchStories" \n              placeholder="Cari cerita berdasarkan nama atau deskripsi..." \n              class="form-control"\n              style="padding: 12px; border-radius: 8px; border: 1px solid #d8d8d8ff;"\n            />\n          </div>\n          <div id="stories" class="story-list"></div>\n        </section>\n      </section>\n    ')},t)}))()},afterRender:function(){var t=this;return _(w().m(function e(){var n,r;return w().w(function(e){for(;;)switch(e.n){case 0:return n=new p.A,r=new l({view:t,model:n}),window.addEventListener("online",function(){return t._updateOnlineStatus()}),window.addEventListener("offline",function(){return t._updateOnlineStatus()}),t._updateOnlineStatus(),document.getElementById("searchStories").addEventListener("input",function(t){r.searchStories(t.target.value)}),e.n=1,r.showStories();case 1:t._animateElements();case 2:return e.a(2)}},e)}))()},_updateOnlineStatus:function(){var t=document.getElementById("offline-banner");navigator.onLine?t.style.display="none":t.style.display="block"},showOfflineEmptyState:function(){document.getElementById("stories").innerHTML='\n      <p style="text-align:center;">\n        Anda sedang offline dan belum ada data yang tersimpan.\n      </p>\n    '},showOfflineError:function(){document.getElementById("stories").innerHTML='\n      <p style="text-align:center;">\n        Gagal memuat data. Periksa koneksi internet Anda.\n      </p>\n    '},_initNotificationButton:function(){var t=document.getElementById("notifToggle");"Notification"in window?t.addEventListener("click",_(w().m(function e(){return w().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,g.default.requestPermission();case 1:if(!e.v){e.n=3;break}return e.n=2,g.default.subscribePush();case 2:t.innerText="Notifikasi Aktif",t.classList.remove("btn-secondary"),t.classList.add("btn-primary"),Swal.fire("Berhasil","Anda akan menerima notifikasi cerita baru.","success"),e.n=4;break;case 3:Swal.fire("Gagal","Izin notifikasi ditolak.","error");case 4:return e.a(2)}},e)}))):t.style.display="none"},showLoading:function(){document.getElementById("loading-container").innerHTML='<div class="loader" style="text-align:center; padding:2rem;">Memuat data...</div>'},hideLoading:function(){document.getElementById("loading-container").innerHTML=""},showStoriesList:function(t){var e=document.getElementById("stories");e.innerHTML="",0!==t.length?t.forEach(function(t){var n=document.createElement("story-card");n.story=t,e.appendChild(n)}):e.innerHTML="<p style='text-align:center; col-span: 3;'>Tidak ada cerita ditemukan.</p>"},initMap:function(t){!function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=document.getElementById("map");if(e){e._leaflet_id&&(e._leaflet_id=null);var n=y().map("map").setView([-2.5489,118.0149],5),r=y().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"),o=y().tileLayer("https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png");r.addTo(n);var i=[],a=y().layerGroup();t.forEach(function(t){if(t.lat&&t.lon){var e=y().marker([t.lat,t.lon]);e.bindPopup("<b>".concat(t.name,"</b><br>").concat(t.description)),a.addLayer(e),i.push([t.lat,t.lon])}}),a.addTo(n),y().control.layers({Default:r,Satellite:o},{"Lokasi Cerita":a}).addTo(n),i.length>0&&n.fitBounds(i),window.focusStoryOnMap=function(t,e,r){n.setView([t,e],10,{animate:!0}),y().popup().setLatLng([t,e]).setContent("<b>".concat(r,"</b>")).openOn(n)}}}(t)},_animateElements:function(){m.os.from("#map-section",{opacity:0,y:30,duration:.8,ease:"power2.out"}),m.os.from("#stories-section",{opacity:0,y:50,duration:.8,delay:.3,ease:"power2.out"})}}}}]);